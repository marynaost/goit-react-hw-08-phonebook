(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[4],{10:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(24),a=n(7),c=Object(r.a)({reducerPath:"authApi",baseQuery:Object(a.d)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["Auth"],endpoints:function(e){return{registerUser:e.mutation({query:function(e){return{url:"/users/signup",method:"POST",body:e}},invalidatesTags:["Auth"]}),loginUser:e.mutation({query:function(e){return{url:"/users/login",method:"POST",body:e}},invalidatesTags:["Auth"]}),logoutUser:e.mutation({query:function(){return{url:"/users/logout",method:"POST"}},invalidatesTags:["Auth"]}),fetchCurrentUser:e.query({query:function(){return"/users/current"},invalidatesTags:["Auth"]})}}}),o=c.useRegisterUserMutation,i=c.useLoginUserMutation,s=c.useLogoutUserMutation,u=c.useFetchCurrentUserQuery},13:function(e,t,n){e.exports={link:"HeadersStyles_link__3SqwE",active:"HeadersStyles_active__k60Ok HeadersStyles_link__3SqwE"}},22:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return j}));var r=n(16),a=n(2),c=n(24),o=n(7),i=n(30),s=Object(a.d)("",Object(r.a)({},i.a,(function(e,t){return t.payload}))),u=Object(c.a)({reducerPath:"contactsApi",baseQuery:Object(o.d)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["Contact"],endpoints:function(e){return{fetchContacts:e.query({query:function(){return"/contacts"},keepUnusedDataFor:5,providesTags:["Contact"]}),deleteContacts:e.mutation({query:function(e){return{url:"/contacts/".concat(e),method:"DELETE"}},invalidatesTags:["Contact"]}),addContact:e.mutation({query:function(e){return{url:"/contacts",method:"POST",body:e}},invalidatesTags:["Contact"]})}}}),d=u.useFetchContactsQuery,l=u.useDeleteContactsMutation,j=u.useAddContactMutation},25:function(e,t,n){e.exports={container:"UserMenu_container__3JXUj",name:"UserMenu_name__3DVRV",button:"UserMenu_button__2jAoZ"}},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.b)("contact/changeFilter")},34:function(e,t,n){e.exports={container:"Container_container__2Bbch"}},48:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),o=n(19),i=n.n(o),s=n(5),u=n(32),d=n(36),l=n(16),j=n(2),b=n(7),h=n(15),g=n(17),O=function(e){return function(e){return function(t){var n,r,a,c,o,i,s,u;Object(j.m)(t)&&(400===(null===(n=t.payload)||void 0===n?void 0:n.status)&&null!==(r=t.payload)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.message?g.b.error("".concat(null===(s=t.payload)||void 0===s||null===(u=s.data)||void 0===u?void 0:u.message)):400===(null===(c=t.payload)||void 0===c?void 0:c.status)?g.b.error("Mail and password entered incorrectly"):401===(null===(o=t.payload)||void 0===o?void 0:o.status)?g.b.error("Unauthorized"):500===(null===(i=t.payload)||void 0===i?void 0:i.status)?g.b.error("Server error"):g.b.error("Bad Request"));return e(t)}}},f=n(33),v=n.n(f),p=n(10),m=Object(j.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:function(e){e.addMatcher(p.a.endpoints.registerUser.matchFulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),e.addMatcher(p.a.endpoints.loginUser.matchFulfilled,(function(e,t){var n=t.payload;e.user=n.user,e.token=n.token,e.isLoggedIn=!0})),e.addMatcher(p.a.endpoints.logoutUser.matchFulfilled,(function(e){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),e.addMatcher(p.a.endpoints.fetchCurrentUser.matchFulfilled,(function(e,t){var n=t.payload;e.user=n,e.isLoggedIn=!0}))}}),x=n(22),y={key:"auth",storage:v.a,whitelist:["token"]},k=Object(j.a)({reducer:(r={auth:Object(h.g)(y,m.reducer)},Object(l.a)(r,p.a.reducerPath,p.a.reducer),Object(l.a)(r,x.a.reducerPath,x.a.reducer),Object(l.a)(r,"filter",x.b),r),middleware:function(e){return[].concat(Object(d.a)(e({serializableCheck:{ignoredActions:[h.a,h.f,h.b,h.c,h.d,h.e]}})),[O,x.a.middleware,p.a.middleware])},devTools:!1});Object(b.e)(k.dispatch);var T=Object(h.h)(k),U=n(12),_=(n(47),n(48),n(3)),I=n(34),C=n.n(I),L=n(1);function A(e){var t=e.children;return Object(L.jsx)("div",{className:C.a.container,children:t})}var S={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUsername:function(e){return e.auth.user.name},getToken:function(e){return e.auth.token}},M=n(13),w=n.n(M),q=function(){var e=Object(s.e)(S.getIsLoggedIn);return Object(L.jsxs)("nav",{children:[Object(L.jsx)(U.b,{to:"/",className:function(e){return e.isActive?w.a.active:w.a.link},children:"Home"}),e&&Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(U.b,{to:"/contacts",className:function(e){return e.isActive?w.a.active:w.a.link},children:"Contacts"})})]})},F=n(14),P=n(25),z=n.n(P);function N(){var e=Object(s.e)(S.getUsername),t=Object(p.d)(),n=Object(F.a)(t,1)[0];return Object(L.jsxs)("div",{className:z.a.container,children:[Object(L.jsxs)("span",{className:z.a.name,children:["Wellcome, ",e]}),Object(L.jsx)("button",{type:"button",className:z.a.button,onClick:function(){return n()},children:"Log out"})]})}function E(e){return Object(L.jsxs)("div",{children:[Object(L.jsx)(U.b,{to:"/register",className:function(e){return e.isActive?w.a.active:w.a.link},children:"Registration"}),Object(L.jsx)(U.b,{to:"/login",className:function(e){return e.isActive?w.a.active:w.a.link},children:"Login"})]})}var H={header:{display:"flex",justifyContent:"space-between",alignItems:"center"}};function B(){var e=Object(s.e)(S.getIsLoggedIn);return Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)("header",{style:H.header,children:[Object(L.jsx)(q,{}),e?Object(L.jsx)(N,{}):Object(L.jsx)(E,{})]})})}function R(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,a=e.redirectTo,c=void 0===a?"/":a;return Object(s.e)(S.getIsLoggedIn)&&r?Object(L.jsx)(_.a,{to:c}):t}function D(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/":n;return Object(s.e)(S.getIsLoggedIn)?t:Object(L.jsx)(_.a,{to:r})}n(50),n(37);var Q=Object(a.lazy)((function(){return n.e(2).then(n.bind(null,74))})),J=Object(a.lazy)((function(){return n.e(1).then(n.bind(null,78))})),V=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,75))})),W=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,76))}));function X(){var e=Object(s.e)(S.getToken),t=Object(s.e)(S.getIsLoggedIn),n=Object(p.b)(e,{skip:null===e}).isLoading;return Object(L.jsx)(A,{children:!n&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(B,{}),Object(L.jsx)(a.Suspense,{fallback:Object(L.jsx)("h1",{style:{textAlign:"center",color:"white"},children:"Loading.."}),children:Object(L.jsxs)(_.d,{children:[Object(L.jsx)(_.b,{path:"/",element:Object(L.jsx)(R,{children:Object(L.jsx)(Q,{})})}),Object(L.jsx)(_.b,{path:"register",element:Object(L.jsx)(R,{redirectTo:"/contacts",restricted:!0,children:Object(L.jsx)(V,{})})}),Object(L.jsx)(_.b,{path:"login",element:Object(L.jsx)(R,{redirectTo:"/contacts",restricted:!0,children:Object(L.jsx)(W,{})})}),Object(L.jsx)(_.b,{path:"contacts",element:Object(L.jsx)(D,{redirectTo:"/login",children:Object(L.jsx)(J,{})})}),Object(L.jsx)(_.b,{path:"*",element:t?Object(L.jsx)(J,{}):Object(L.jsx)(Q,{})})]})}),Object(L.jsx)(g.a,{autoClose:2e3})]})})}i.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(s.a,{store:k,children:Object(L.jsx)(u.a,{loading:null,persistor:T,children:Object(L.jsx)(U.a,{children:Object(L.jsx)(X,{})})})})}),document.getElementById("root"))}},[[51,6,7]]]);
//# sourceMappingURL=main.c1b1a22a.chunk.js.map